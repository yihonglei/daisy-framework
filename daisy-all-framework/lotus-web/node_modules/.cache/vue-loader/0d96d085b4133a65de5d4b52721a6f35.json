{"remainingRequest":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hq_ly/mhjy/mhjy_manager/src/views/permission/directive.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/hq_ly/mhjy/mhjy_manager/src/views/permission/directive.vue","mtime":1659938322663},{"path":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnCmltcG9ydCB7IGRlZXBDbG9uZSB9IGZyb20gJ0AvdXRpbHMnCmltcG9ydCB7IGdldFJvbGVzfSBmcm9tICdAL2FwaS9yb2xlJwppbXBvcnQgeyBnZXRTeXNVc2Vyc0xpc3QsIGFkZFN5c1VzZXIsIHVwZGF0ZVN5c1VzZXIsIGRlbFN5c1VzZXIgfSBmcm9tICdAL2FwaS91c2VyJwppbXBvcnQgeyBnZXRUb2tlbiwgc2V0VG9rZW4sIHJlbW92ZVRva2VuIH0gZnJvbSAnQC91dGlscy9hdXRoJwppbXBvcnQgY2hlY2tQZXJtaXNzaW9uIGZyb20gJ0AvdXRpbHMvcGVybWlzc2lvbicgLy8g5p2D6ZmQ5Yik5pat5Ye95pWwCgpjb25zdCBkZWZhdWx0VXNlciA9IHsKICBpZDogMCwKICB1c2VybmFtZTogJycsCiAgYXZhdGFyOiAnJywKICBuYW1lOiAnJywKICBwaG9uZTogJycsCiAgYWxpcGF5OiAnJywKICByb2xlc0RhdGE6IFtdCn0KCmV4cG9ydCBkZWZhdWx0IHsKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgdXNlcjogT2JqZWN0LmFzc2lnbih7fSwgZGVmYXVsdFVzZXIpLAogICAgICByb2xlczogW10sCiAgICAgIHVzZXJzTGlzdDogW10sCiAgICAgIGRhdGFPYmo6IHsgdG9rZW46ICcnLCBrZXk6ICcnIH0sCiAgICAgIGRpYWxvZ1Zpc2libGU6IGZhbHNlLAogICAgICBkaWFsb2dUeXBlOiAnbmV3JywKICAgICAgY2hlY2tTdHJpY3RseTogZmFsc2UsCiAgICAgIGRlZmF1bHRQcm9wczogewogICAgICAgIGxhYmVsOiAndGl0bGUnLAogICAgICAgIHRpdGxlOiAndGl0bGUnLAogICAgICAgIGlkOiAwCiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICByb2xlc0RhdGEoKSB7CiAgICAgIHJldHVybiB0aGlzLnJvbGVzCiAgICB9CiAgfSwKICBmaWx0ZXJzOnsKICAgIGZpbHRlclN0YXR1cyhzdGF0dXMpIHsKICAgICAgaWYgKHN0YXR1cyA9PSAxKSB7CiAgICAgICAgcmV0dXJuICLmraPluLgiCiAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09IDIpIHsKICAgICAgICByZXR1cm4gIuemgeeUqCIKICAgICAgfQogICAgfSwKICAgIGZpbHRlclJvbGVzKHJvbGVzKSB7CiAgICAgIGxldCB0bXBSb2xlcyA9IFtdCiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgcm9sZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBsZXQgcm9sZSA9IHJvbGVzW2ldCiAgICAgICAgdG1wUm9sZXMucHVzaChyb2xlLm5hbWUpCiAgICAgIH0KCiAgICAgIHJldHVybiB0bXBSb2xlcy5qb2luKCcsJykKICAgIH0KICB9LAogIGNyZWF0ZWQoKSB7CiAgICAvLyBNb2NrOiBnZXQgYWxsIHJvdXRlcyBhbmQgcm9sZXMgbGlzdCBmcm9tIHNlcnZlcgogICAgdGhpcy5nZXRSb2xlcygpCiAgICB0aGlzLmdldFN5c1VzZXJzTGlzdCgpCiAgfSwKICBtZXRob2RzOiB7CiAgICBjaGVja1Blcm1pc3Npb24sCiAgICBhc3luYyBnZXRSb2xlcygpIHsKICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0Um9sZXMoKQogICAgICBsZXQgcm9sZXMgPSByZXMuZGF0YQogICAgICB0aGlzLnJvbGVzID0gdGhpcy5nZW5lcmF0ZVJvbGVzKHJvbGVzKQogICAgfSwKICAgIGFzeW5jIGdldFN5c1VzZXJzTGlzdCgpIHsKICAgICAgY29uc3QgcmVzID0gYXdhaXQgZ2V0U3lzVXNlcnNMaXN0KHt0b2tlbjpnZXRUb2tlbigpfSkKICAgICAgdGhpcy51c2Vyc0xpc3QgPSByZXMuZGF0YQogICAgfSwKCiAgICAvLyBSZXNoYXBlIHRoZSByb3V0ZXMgc3RydWN0dXJlIHNvIHRoYXQgaXQgbG9va3MgdGhlIHNhbWUgYXMgdGhlIHNpZGViYXIKICAgIGdlbmVyYXRlUm9sZXMocm9sZXMpIHsKICAgICAgY29uc3QgcmVzID0gW10KCiAgICAgIGZvciAobGV0IHJvbGUgb2Ygcm9sZXMpIHsKICAgICAgICBjb25zdCBkYXRhID0gewogICAgICAgICAgdGl0bGU6IHJvbGUubmFtZSwKICAgICAgICAgIGxhYmVsOiByb2xlLm5hbWUsCiAgICAgICAgICBpZDogcm9sZS5pZAogICAgICAgIH0KICAgICAgICByZXMucHVzaChkYXRhKQogICAgICB9CiAgICAgIHJldHVybiByZXMKICAgIH0sCgogICAgZ2VuZXJhdGVBcnIocm9sZXMpIHsKICAgICAgbGV0IGRhdGEgPSBbXQogICAgICByb2xlcy5mb3JFYWNoKHJvbGUgPT4gewogICAgICAgIGRhdGEucHVzaChyb2xlKQogICAgICB9KQogICAgICByZXR1cm4gZGF0YQogICAgfSwKICAgIGhhbmRsZUFkZFVzZXIoKSB7CiAgICAgIHRoaXMudXNlciA9IE9iamVjdC5hc3NpZ24oe30sIGRlZmF1bHRVc2VyKQogICAgICBpZiAodGhpcy4kcmVmcy50cmVlKSB7CiAgICAgICAgdGhpcy4kcmVmcy50cmVlLnNldENoZWNrZWROb2RlcyhbXSkKICAgICAgfQogICAgICB0aGlzLmRpYWxvZ1R5cGUgPSAnbmV3JwogICAgICB0aGlzLmRpYWxvZ1Zpc2libGUgPSB0cnVlCiAgICB9LAogICAgaGFuZGxlRWRpdChzY29wZSkgewogICAgICB0aGlzLmRpYWxvZ1R5cGUgPSAnZWRpdCcKICAgICAgdGhpcy5kaWFsb2dWaXNpYmxlID0gdHJ1ZQogICAgICB0aGlzLmNoZWNrU3RyaWN0bHkgPSB0cnVlCiAgICAgIHRoaXMudXNlciA9IGRlZXBDbG9uZShzY29wZS5yb3cpCiAgICAgIHRoaXMuJG5leHRUaWNrKCgpID0+IHsKICAgICAgICBjb25zdCByb2xlcyA9IHRoaXMuZ2VuZXJhdGVSb2xlcyh0aGlzLnJvbGVzRGF0YSkKICAgICAgICB0aGlzLiRyZWZzLnRyZWUuc2V0Q2hlY2tlZE5vZGVzKHRoaXMuZ2VuZXJhdGVBcnIodGhpcy51c2VyLnJvbGVzKSkKICAgICAgICAvLyBzZXQgY2hlY2tlZCBzdGF0ZSBvZiBhIG5vZGUgbm90IGFmZmVjdHMgaXRzIGZhdGhlciBhbmQgY2hpbGQgbm9kZXMKICAgICAgICB0aGlzLmNoZWNrU3RyaWN0bHkgPSBmYWxzZQogICAgICB9KQogICAgfSwKICAgIGhhbmRsZURlbGV0ZSh7ICRpbmRleCwgcm93IH0pIHsKICAgICAgaWYgKHJvdy5pZCA9PSAxKSB7CiAgICAgICAgdGhpcy4kbWVzc2FnZSh7CiAgICAgICAgICB0eXBlOiAnd2FybmluZycsCiAgICAgICAgICBtZXNzYWdlOiAn6LaF57qn566h55CG5ZGY5peg5rOV5Yig6ZmkIScKICAgICAgICB9KQogICAgICAgIHJldHVybgogICAgICB9CiAgICAgIHRoaXMuJGNvbmZpcm0oJ+ehruWumuWIoOmZpOatpOeUqOaItz8nLCAn5o+Q56S6JywgewogICAgICAgIGNvbmZpcm1CdXR0b25UZXh0OiAn56Gu6K6kJywKICAgICAgICBjYW5jZWxCdXR0b25UZXh0OiAn5Y+W5raIJywKICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgfSkKICAgICAgICAudGhlbihhc3luYygpID0+IHsKICAgICAgICAgIGF3YWl0IGRlbFN5c1VzZXIoeydpZCc6cm93LmlkfSkKICAgICAgICAgIHRoaXMudXNlcnNMaXN0LnNwbGljZSgkaW5kZXgsIDEpCiAgICAgICAgICB0aGlzLiRtZXNzYWdlKHsKICAgICAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnLAogICAgICAgICAgICBtZXNzYWdlOiAn5Yig6Zmk5oiQ5YqfIScKICAgICAgICAgIH0pCiAgICAgICAgfSkKICAgICAgICAuY2F0Y2goZXJyID0+IHsgY29uc29sZS5lcnJvcihlcnIpIH0pCiAgICB9LAogICAgYXN5bmMgY29uZmlybXVzZXIoKSB7CiAgICAgIGNvbnN0IGlzRWRpdCA9IHRoaXMuZGlhbG9nVHlwZSA9PT0gJ2VkaXQnCgogICAgICBjb25zdCBjaGVja2VkS2V5cyA9IHRoaXMuJHJlZnMudHJlZS5nZXRDaGVja2VkS2V5cygpCiAgICAgIHRoaXMudXNlci5yb2xlSWRzID0gY2hlY2tlZEtleXMuam9pbignLCcpCgogICAgICBpZiAoaXNFZGl0KSB7CiAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCB1cGRhdGVTeXNVc2VyKHRoaXMudXNlcikKICAgICAgICB0aGlzLnVzZXIucm9sZXMgPSBkYXRhLnJvbGVzCiAgICAgICAgZm9yIChsZXQgaW5kZXggPSAwOyBpbmRleCA8IHRoaXMudXNlcnNMaXN0Lmxlbmd0aDsgaW5kZXgrKykgewogICAgICAgICAgaWYgKHRoaXMudXNlcnNMaXN0W2luZGV4XS5pZCA9PT0gdGhpcy5yb2xlLmlkKSB7CiAgICAgICAgICAgIHRoaXMudXNlcnNMaXN0LnNwbGljZShpbmRleCwgMSwgT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5yb2xlKSkKICAgICAgICAgICAgYnJlYWsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBhZGRTeXNVc2VyKHRoaXMudXNlcikKICAgICAgICB0aGlzLnVzZXIuaWQgPSBkYXRhLmlkCiAgICAgICAgdGhpcy51c2VyLnJvbGVzID0gZGF0YS5yb2xlcwogICAgICAgIHRoaXMudXNlcnNMaXN0LnB1c2godGhpcy51c2VyKQogICAgICB9CgogICAgICBjb25zdCB7IGlkLCB1c2VybmFtZSwgbmFtZSB9ID0gdGhpcy51c2VyCiAgICAgIHRoaXMuZGlhbG9nVmlzaWJsZSA9IGZhbHNlCiAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgdGl0bGU6ICdTdWNjZXNzJywKICAgICAgICBkYW5nZXJvdXNseVVzZUhUTUxTdHJpbmc6IHRydWUsCiAgICAgICAgbWVzc2FnZTogYAogICAgICAgICAgICA8ZGl2PueUqOaIt0lEOiAke2lkfTwvZGl2PgogICAgICAgICAgICA8ZGl2PueUqOaIt+WQjTogJHt1c2VybmFtZX08L2Rpdj4KICAgICAgICAgICAgPGRpdj7nnJ/lrp7lp5PlkI06ICR7bmFtZX08L2Rpdj4KICAgICAgICAgIGAsCiAgICAgICAgdHlwZTogJ3N1Y2Nlc3MnCiAgICAgIH0pCiAgICB9LAoKICAgIGVtaXRJbnB1dCh2YWwpIHsKICAgICAgY29uc29sZS5sb2coJzEvPT09PT09PT0nKQogICAgICBjb25zb2xlLmxvZyh2YWwpCiAgICAgIHRoaXMuJGVtaXQoJ2lucHV0JywgdmFsKQogICAgfSwKICAgIGhhbmRsZUltYWdlU3VjY2VzcyhmaWxlKSB7CiAgICAgIC8vIGNvbnNvbGUubG9nKCcyLz09PT09PT09JykKICAgICAgLy8gY29uc29sZS5sb2coZmlsZSkKICAgICAgLy8gdGhpcy5lbWl0SW5wdXQoZmlsZS5maWxlcy5maWxlKQogICAgICB0aGlzLnVwbG9hZFVSTChmaWxlLmZpbGVzLmZpbGUpCiAgICB9LAogICAgYmVmb3JlVXBsb2FkKCkgewogICAgICBjb25zdCBfc2VsZiA9IHRoaXMKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgICBnZXRUb2tlbigpLnRoZW4ocmVzcG9uc2UgPT4gewogICAgICAgICAgY29uc3Qga2V5ID0gcmVzcG9uc2UuZGF0YS5xaW5pdV9rZXkKICAgICAgICAgIGNvbnN0IHRva2VuID0gcmVzcG9uc2UuZGF0YS5xaW5pdV90b2tlbgogICAgICAgICAgX3NlbGYuX2RhdGEuZGF0YU9iai50b2tlbiA9IHRva2VuCiAgICAgICAgICBfc2VsZi5fZGF0YS5kYXRhT2JqLmtleSA9IGtleQogICAgICAgICAgdGhpcy50ZW1wVXJsID0gcmVzcG9uc2UuZGF0YS5xaW5pdV91cmwKICAgICAgICAgIHJlc29sdmUodHJ1ZSkKICAgICAgICB9KS5jYXRjaChlcnIgPT4gewogICAgICAgICAgY29uc29sZS5sb2coZXJyKQogICAgICAgICAgcmVqZWN0KGZhbHNlKQogICAgICAgIH0pCiAgICAgIH0pCiAgICB9LAogICAgdXBsb2FkVVJMKGZpbGUpIHsKICAgIAlsZXQgdGhhdCA9IHRoaXMKICAgIAkvL+azqOaEj+WTpu+8jOi/memHjOaMh+WumuaWh+S7tuWkuSdpbWFnZS8n77yM5bCd6K+V6L+H5YaZ5Zyo6YWN572u5paH5Lu277yM5L2G5piv5ZCE56eN5LiN6KGM77yM5YaZ5Zyo6L+Z6YeM5bCx5Y+v5LulCiAgICAJdmFyIGZpbGVOYW1lID0gJ21oankvJyArICdoZWFkZXInICsgZ2V0RmlsZU5hbWVVVUlEKCkgKyAnLmpwZyc7CiAgICAJLy/lrprkuYnllK/kuIDnmoTmlofku7blkI3vvIzmiZPljbDlh7rmnaXnmoR1aWTlhbblrp7lsLHmmK/ml7bpl7TmiLMKICAgIAljbGllbnQoKS5tdWx0aXBhcnRVcGxvYWQoZmlsZU5hbWUsIGZpbGUsIHsKICAgIAkJcHJvZ3Jlc3M6IGZ1bmN0aW9uKHBlcmNlbnRhZ2UsIGNwdCkgewogICAgCQkJY29uc29sZS5sb2coJ+aJk+WNsOi/m+W6picsIHBlcmNlbnRhZ2UpCiAgICAJCX0KICAgIAl9KS50aGVuKChyZXMpID0+IHsKICAgIAkJLy/mraTlpITotYvlgLzvvIzmmK/nm7jlvZPkuo7kuIrkvKDmiJDlip/kuYvlkI7vvIzmiYvliqjmi7zmjqXmnI3liqHlmajlnLDlnYDlkozmlofku7blkI0KICAgIAkJdGhpcy51c2VyLmF2YXRhciA9ICdodHRwczovL2J6cnJtZWRpYS5vc3MtY24tYmVpamluZy5hbGl5dW5jcy5jb20vJyArIGZpbGVOYW1lOwogICAgICAgIGNvbnNvbGUubG9nKCcrKysrKysrKysrJykKICAgICAgICBjb25zb2xlLmxvZyh0aGlzLnVzZXIuYXZhdGFyKQogICAgCX0pCiAgICB9LAoKICB9Cn0K"},{"version":3,"sources":["directive.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAmHA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"directive.vue","sourceRoot":"src/views/permission","sourcesContent":["<template>\n  <div class=\"app-container\">\n    <el-button v-if=\"checkPermission(['admin'])\" type=\"primary\" @click=\"handleAddUser\">新建用户</el-button>\n\n    <el-table :data=\"usersList\" style=\"width: 100%;margin-top:30px;\" border>\n      <el-table-column align=\"center\" label=\"ID\" width=\"50\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.id }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"center\" label=\"用户名\" width=\"220\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.username }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"header-center\" label=\"头像\" width=\"120\">\n        <template slot-scope=\"scope\">\n          <img :src=\"scope.row.avatar\" style=\"width: 80px;height: 80px;\" />\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" label=\"邀请码\" width=\"220\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.attcode }}\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" label=\"角色\" width=\"220\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.roles|filterRoles }}\n        </template>\n      </el-table-column>\n\n      <el-table-column align=\"center\" label=\"状态\" width=\"120\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.status|filterStatus }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"header-center\" label=\"创建时间\" width=\"220\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.created_time }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"header-center\" label=\"创建人\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.created_by_username }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"header-center\" label=\"更新时间\" width=\"220\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.updated_time }}\n        </template>\n      </el-table-column>\n      <el-table-column align=\"header-center\" label=\"更新人\">\n        <template slot-scope=\"scope\">\n          {{ scope.row.updated_by_username }}\n        </template>\n      </el-table-column>\n      <el-table-column v-if=\"checkPermission(['admin'])\" align=\"center\" label=\"操作\" width=\"300\">\n        <template slot-scope=\"scope\">\n          <el-button type=\"primary\" size=\"small\" @click=\"handleEdit(scope)\">编辑</el-button>\n          <el-button type=\"danger\" size=\"small\" @click=\"handleDelete(scope)\">删除</el-button>\n          <el-button type=\"danger\" size=\"small\" @click=\"handleResetPWD(scope)\">重置密码</el-button>\n        </template>\n      </el-table-column>\n    </el-table>\n\n    <el-dialog :visible.sync=\"dialogVisible\" :title=\"dialogType==='edit'?'编辑用户':'新建用户'\">\n      <el-form :model=\"user\" label-width=\"100px\" label-position=\"left\">\n        <el-form-item label=\"用户名\">\n          <el-input v-model=\"user.username\" placeholder=\"用户名\" />\n        </el-form-item>\n        <el-form-item label=\"头像\">\n          <el-upload\n            :data=\"dataObj\"\n            :multiple=\"false\"\n            :show-file-list=\"false\"\n            :on-success=\"handleImageSuccess\"\n            class=\"image-uploader\"\n            action=\"https://httpbin.org/post\"\n          >\n            <img :src=\"user.avatar+'?imageView2/1/w/80/h/80'\" class=\"image-uploader\" >\n            </img>\n          </el-upload>\n        </el-form-item>\n        <el-form-item label=\"真实姓名\">\n          <el-input v-model=\"user.name\" placeholder=\"真实姓名\"/>\n        </el-form-item>\n        <el-form-item label=\"手机号\">\n          <el-input v-model=\"user.phone\" placeholder=\"手机号\"/>\n        </el-form-item>\n        <el-form-item label=\"支付宝账号\">\n          <el-input v-model=\"user.alipay\" placeholder=\"支付宝账号\"/>\n        </el-form-item>\n        <el-form-item label=\"角色\">\n          <el-tree\n            ref=\"tree\"\n            :check-strictly=\"checkStrictly\"\n            :data=\"rolesData\"\n            :props=\"defaultProps\"\n            show-checkbox\n            node-key=\"id\"\n            class=\"permission-tree\"\n          />\n        </el-form-item>\n      </el-form>\n      <div style=\"text-align:right;\">\n        <el-button type=\"danger\" @click=\"dialogVisible=false\">取消</el-button>\n        <el-button type=\"primary\" @click=\"confirmuser\">提交</el-button>\n      </div>\n    </el-dialog>\n  </div>\n</template>\n\n<script>\nimport path from 'path'\nimport { deepClone } from '@/utils'\nimport { getRoles} from '@/api/role'\nimport { getSysUsersList, addSysUser, updateSysUser, delSysUser } from '@/api/user'\nimport { getToken, setToken, removeToken } from '@/utils/auth'\nimport checkPermission from '@/utils/permission' // 权限判断函数\n\nconst defaultUser = {\n  id: 0,\n  username: '',\n  avatar: '',\n  name: '',\n  phone: '',\n  alipay: '',\n  rolesData: []\n}\n\nexport default {\n  data() {\n    return {\n      user: Object.assign({}, defaultUser),\n      roles: [],\n      usersList: [],\n      dataObj: { token: '', key: '' },\n      dialogVisible: false,\n      dialogType: 'new',\n      checkStrictly: false,\n      defaultProps: {\n        label: 'title',\n        title: 'title',\n        id: 0\n      }\n    }\n  },\n  computed: {\n    rolesData() {\n      return this.roles\n    }\n  },\n  filters:{\n    filterStatus(status) {\n      if (status == 1) {\n        return \"正常\"\n      } else if (status == 2) {\n        return \"禁用\"\n      }\n    },\n    filterRoles(roles) {\n      let tmpRoles = []\n      for (var i = 0; i < roles.length; i++) {\n        let role = roles[i]\n        tmpRoles.push(role.name)\n      }\n\n      return tmpRoles.join(',')\n    }\n  },\n  created() {\n    // Mock: get all routes and roles list from server\n    this.getRoles()\n    this.getSysUsersList()\n  },\n  methods: {\n    checkPermission,\n    async getRoles() {\n      const res = await getRoles()\n      let roles = res.data\n      this.roles = this.generateRoles(roles)\n    },\n    async getSysUsersList() {\n      const res = await getSysUsersList({token:getToken()})\n      this.usersList = res.data\n    },\n\n    // Reshape the routes structure so that it looks the same as the sidebar\n    generateRoles(roles) {\n      const res = []\n\n      for (let role of roles) {\n        const data = {\n          title: role.name,\n          label: role.name,\n          id: role.id\n        }\n        res.push(data)\n      }\n      return res\n    },\n\n    generateArr(roles) {\n      let data = []\n      roles.forEach(role => {\n        data.push(role)\n      })\n      return data\n    },\n    handleAddUser() {\n      this.user = Object.assign({}, defaultUser)\n      if (this.$refs.tree) {\n        this.$refs.tree.setCheckedNodes([])\n      }\n      this.dialogType = 'new'\n      this.dialogVisible = true\n    },\n    handleEdit(scope) {\n      this.dialogType = 'edit'\n      this.dialogVisible = true\n      this.checkStrictly = true\n      this.user = deepClone(scope.row)\n      this.$nextTick(() => {\n        const roles = this.generateRoles(this.rolesData)\n        this.$refs.tree.setCheckedNodes(this.generateArr(this.user.roles))\n        // set checked state of a node not affects its father and child nodes\n        this.checkStrictly = false\n      })\n    },\n    handleDelete({ $index, row }) {\n      if (row.id == 1) {\n        this.$message({\n          type: 'warning',\n          message: '超级管理员无法删除!'\n        })\n        return\n      }\n      this.$confirm('确定删除此用户?', '提示', {\n        confirmButtonText: '确认',\n        cancelButtonText: '取消',\n        type: 'warning'\n      })\n        .then(async() => {\n          await delSysUser({'id':row.id})\n          this.usersList.splice($index, 1)\n          this.$message({\n            type: 'success',\n            message: '删除成功!'\n          })\n        })\n        .catch(err => { console.error(err) })\n    },\n    async confirmuser() {\n      const isEdit = this.dialogType === 'edit'\n\n      const checkedKeys = this.$refs.tree.getCheckedKeys()\n      this.user.roleIds = checkedKeys.join(',')\n\n      if (isEdit) {\n        const { data } = await updateSysUser(this.user)\n        this.user.roles = data.roles\n        for (let index = 0; index < this.usersList.length; index++) {\n          if (this.usersList[index].id === this.role.id) {\n            this.usersList.splice(index, 1, Object.assign({}, this.role))\n            break\n          }\n        }\n      } else {\n        const { data } = await addSysUser(this.user)\n        this.user.id = data.id\n        this.user.roles = data.roles\n        this.usersList.push(this.user)\n      }\n\n      const { id, username, name } = this.user\n      this.dialogVisible = false\n      this.$notify({\n        title: 'Success',\n        dangerouslyUseHTMLString: true,\n        message: `\n            <div>用户ID: ${id}</div>\n            <div>用户名: ${username}</div>\n            <div>真实姓名: ${name}</div>\n          `,\n        type: 'success'\n      })\n    },\n\n    emitInput(val) {\n      console.log('1/========')\n      console.log(val)\n      this.$emit('input', val)\n    },\n    handleImageSuccess(file) {\n      // console.log('2/========')\n      // console.log(file)\n      // this.emitInput(file.files.file)\n      this.uploadURL(file.files.file)\n    },\n    beforeUpload() {\n      const _self = this\n      return new Promise((resolve, reject) => {\n        getToken().then(response => {\n          const key = response.data.qiniu_key\n          const token = response.data.qiniu_token\n          _self._data.dataObj.token = token\n          _self._data.dataObj.key = key\n          this.tempUrl = response.data.qiniu_url\n          resolve(true)\n        }).catch(err => {\n          console.log(err)\n          reject(false)\n        })\n      })\n    },\n    uploadURL(file) {\n    \tlet that = this\n    \t//注意哦，这里指定文件夹'image/'，尝试过写在配置文件，但是各种不行，写在这里就可以\n    \tvar fileName = 'mhjy/' + 'header' + getFileNameUUID() + '.jpg';\n    \t//定义唯一的文件名，打印出来的uid其实就是时间戳\n    \tclient().multipartUpload(fileName, file, {\n    \t\tprogress: function(percentage, cpt) {\n    \t\t\tconsole.log('打印进度', percentage)\n    \t\t}\n    \t}).then((res) => {\n    \t\t//此处赋值，是相当于上传成功之后，手动拼接服务器地址和文件名\n    \t\tthis.user.avatar = 'https://bzrrmedia.oss-cn-beijing.aliyuncs.com/' + fileName;\n        console.log('++++++++++')\n        console.log(this.user.avatar)\n    \t})\n    },\n\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n.app-container {\n  .roles-table {\n    margin-top: 30px;\n  }\n  .permission-tree {\n    margin-bottom: 30px;\n  }\n  .image-uploader {\n    background-color: #5cd7f7;\n    width: 80px;\n    height: 80px;\n    border-radius: 40px;\n    color: #000000;\n  }\n}\n</style>\n"]}]}