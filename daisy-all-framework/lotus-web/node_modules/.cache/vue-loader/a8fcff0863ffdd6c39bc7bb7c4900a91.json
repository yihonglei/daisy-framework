{"remainingRequest":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/hq_ly/mhjy/mhjy_manager/src/views/homecenter/page.vue?vue&type=style&index=0&id=51a589a0&lang=scss&scoped=true&","dependencies":[{"path":"/Users/hq_ly/mhjy/mhjy_manager/src/views/homecenter/page.vue","mtime":1662345599430},{"path":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/css-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/vue-loader/lib/loaders/stylePostLoader.js","mtime":1655715156000},{"path":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/postcss-loader/src/index.js","mtime":499162500000},{"path":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/sass-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/hq_ly/mhjy/mhjy_manager/node_modules/vue-loader/lib/index.js","mtime":1655715099000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5hcHAtY29udGFpbmVyIHsKCiAgLmltYWdlLXVwbG9hZGVyIHsKICAgIGJhY2tncm91bmQtY29sb3I6ICM1Y2Q3Zjc7CiAgICB3aWR0aDogODBweDsKICAgIGhlaWdodDogODBweDsKICAgIGJvcmRlci1yYWRpdXM6IDQwcHg7CiAgICBjb2xvcjogIzAwMDAwMDsKICB9Cn0K"},{"version":3,"sources":["page.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuYA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"page.vue","sourceRoot":"src/views/homecenter","sourcesContent":["<template>\r\n  <div class=\"app-container\">\r\n    <el-tabs v-model=\"activeName\">\r\n      <el-tab-pane label=\"轮播图\" name=\"first\">\r\n        <div class=\"filter-container\" style=\"margin-top: 20px;\">\r\n          <el-button v-waves class=\"filter-item\" style=\"margin-left: 10px;\" type=\"primary\" @click=\"handleAddImage\">\r\n            新增轮播图\r\n          </el-button>\r\n        </div>\r\n        <el-table :data=\"imageList\" style=\"width: 100%;margin-top:10px;\">\r\n          <el-table-column align=\"center\" label=\"ID\" width=\"50\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.id }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"位置\" width=\"120\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.place|filterPlace }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"header-center\" label=\"图片\" width=\"120\">\r\n            <template slot-scope=\"scope\">\r\n              <img :src=\"scope.row.src\" style=\"width: 80px;height: 80px;\" />\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"轮播图名称\" width=\"200\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.title }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"状态\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.enable|filterEnable }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"是否启用\" width=\"220\">\r\n            <template slot-scope=\"scope\">\r\n              <el-switch v-model=\"scope.row.enable\" :active-value=\"1\" :inactive-value=\"0\"\r\n                @change=\"switchChange(scope.row)\"></el-switch>\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"类型\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.type|filterType }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"跳转链接\" width=\"200\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.link }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"排序\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.sort }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"生效开始时间\" width=\"220\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.start_at|filterDate }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"生效结束时间\" width=\"220\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.end_at|filterDate }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column align=\"center\" label=\"创建时间\" width=\"220\">\r\n            <template slot-scope=\"scope\">\r\n              {{ scope.row.created_at|filterDate }}\r\n            </template>\r\n          </el-table-column>\r\n          <el-table-column v-if=\"checkPermission(['admin'])\" align=\"center\" label=\"操作\" width=\"150\" fixed=\"right\">\r\n            <template slot-scope=\"scope\">\r\n              <el-button type=\"primary\" size=\"small\" @click=\"handleEdit(scope)\">修改</el-button>\r\n              <el-button type=\"danger\" size=\"small\" @click=\"handleDelete(scope)\">删除</el-button>\r\n            </template>\r\n          </el-table-column>\r\n        </el-table>\r\n      </el-tab-pane>\r\n    </el-tabs>\r\n\r\n    <el-dialog :visible.sync=\"dialogVisible\" :title=\"dialogType==='edit'?'编辑图片':'新建图片'\">\r\n      <el-form :model=\"image\" label-width=\"100px\" label-position=\"left\">\r\n        <el-form-item label=\"图片\">\r\n          <el-upload :data=\"dataObj\" action=\"\" :multiple=\"false\" :show-file-list=\"false\" :http-request=\"httpRequest\"\r\n            :before-upload=\"beforeUpload\" :limit=\"1\" class=\"image-uploader\">\r\n            <img :src=\"image.src+'?imageView2/1/w/80/h/80'\" class=\"image-uploader\">\r\n            </img>\r\n          </el-upload>\r\n        </el-form-item>\r\n\r\n        <el-form-item prop=\"place\" label=\"位置\" label-width=\"100px\" label-position=\"left\">\n            <el-select v-model=\"image.place\" class=\"filter-item\" default-first-option>\n              <el-option v-for=\"item in places\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\"></el-option>\n            </el-select>\n        </el-form-item>\r\n\r\n        <el-form-item label=\"标题\">\r\n          <el-input v-model=\"image.title\" placeholder=\"请输入标题\" />\r\n        </el-form-item>\r\n\r\n        <el-form-item prop=\"sort\" label=\"排序\" label-width=\"100px\" label-position=\"left\">\n          <el-input type=\"number\" min=\"1\" v-model=\"image.sort\"\n            style=\"width: 100px;margin-left: 5px;margin-right: 5px;\"></el-input>\n        </el-form-item>\r\n\r\n        <el-form-item label=\"类型\">\n          <el-select v-model=\"image.type\" class=\"filter-item\" default-first-option>\n            <el-option v-for=\"item in types\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\"></el-option>\n          </el-select>\r\n        </el-form-item>\r\n\r\n        <el-form-item v-if=\"image.type==2\" label=\"链接\">\r\n          <el-input v-model=\"image.link\" placeholder=\"跳转链接\" />\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"是否可用\">\n          <el-checkbox v-model=\"image.enable\" label=\"是否可用\" :true-label=\"1\" :false-label=\"0\"\n            @change=\"handleCheckHidden\"></el-checkbox>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"开始时间\">\n          <el-date-picker class=\"filter-item\" v-model=\"image.start_at\" type=\"date\" placeholder=\"请选择生效时间\"\n            value-format=\"yyyy-MM-dd\"></el-date-picker>\r\n        </el-form-item>\r\n\r\n        <el-form-item label=\"结束时间\">\n          <el-date-picker class=\"filter-item\" v-model=\"image.end_at\" type=\"date\" placeholder=\"请选择失效时间\"\n            value-format=\"yyyy-MM-dd\"></el-date-picker>\r\n        </el-form-item>\r\n\r\n      </el-form>\r\n      <div style=\"text-align:right;\">\r\n        <el-button type=\"danger\" @click=\"dialogVisible=false\">取消</el-button>\r\n        <el-button type=\"primary\" @click=\"confirmImage\">提交</el-button>\r\n      </div>\r\n    </el-dialog>\r\n\r\n  </div>\r\n</template>\r\n\r\n<script>\r\n  import path from 'path'\r\n  import {\r\n    deepClone\r\n  } from '@/utils'\r\n  import {\r\n    getToken,\r\n    setToken,\r\n    removeToken\r\n  } from '@/utils/auth'\r\n  import checkPermission from '@/utils/permission' // 权限判断函数\r\n  import waves from '@/directive/waves/index.js' // 水波纹指令\r\n  import {\r\n    client,\r\n    getFileNameUUID\r\n  } from '@/utils/alioss.js'\r\n\r\n  const defaultImage = {\r\n    id: 0,\r\n    place: 1,\r\n    title: '',\r\n    src: '',\r\n    sort: 1,\r\n    type: 1,\r\n    link: '',\r\n    enable: 1,\r\n    start_at: new Date(),\r\n    end_at: new Date()\r\n  }\r\n\r\n  export default {\r\n    directives: {\r\n      waves\r\n    },\r\n\r\n    data() {\r\n      return {\r\n        startDate: new Date(),\r\n        endDate: new Date(),\r\n        imageList: [],\r\n        image: {\n          id: 0,\n          place: 1,\n          title: '',\n          src: '',\n          sort: 1,\n          type: 1,\n          link: '',\n          enable: 1,\n          start_at: new Date(),\n          end_at: new Date()\n        },\r\n        dialogVisible: false,\r\n        dialogType: 'new',\r\n        checkStrictly: false,\n        dataObj: {\n          token: '',\n          key: ''\n        },\n        places: [{\n          value: 1,\n          label: '首页'\n        }],\n        types: [{\n          value: 1,\n          label: '纯展示'\n        },\n        {\n          value: 2,\n          label: '链接'\n        }],\r\n        activeName: 'first',\r\n        alipaynum: '',\r\n        alipayname: '',\r\n        optionsvalue: {\r\n          value: 2,\r\n          label: '充值成功'\r\n        },\r\n        options: [{\r\n          value: 0,\r\n          label: '全部'\r\n        }, {\r\n          value: 1,\r\n          label: '待充值'\r\n        }, {\r\n          value: 2,\r\n          label: '充值成功'\r\n        }, {\r\n          value: 3,\r\n          label: '充值失败'\r\n        }]\r\n      }\r\n    },\r\n\r\n    filters: {\r\n      filterEnable(enable) {\r\n        if (enable) {\r\n          return \"正常\"\r\n        } else {\r\n          return \"禁用\"\r\n        }\r\n      },\r\n      filterPlace(place) {\r\n        if (place == 1) {\r\n          return '首页'\r\n        }\r\n      },\r\n      filterType(type) {\r\n        if (type == 1) {\r\n          return '纯展示'\r\n        } else if (type == 2) {\r\n          return '链接跳转'\r\n        }\r\n      },\r\n      filterDate(date) {\r\n        var time = new Date(date)\r\n        var year = time.getFullYear();\r\n        var month = time.getMonth() + 1;\r\n        var dates = time.getDate();\r\n        var hour = time.getHours();\r\n        hour = hour < 10 ? '0' + hour : hour;\r\n        var minute = time.getMinutes();\r\n        minute = minute < 10 ? '0' + minute : minute;\r\n        var second = time.getSeconds();\r\n        second = second < 10 ? '0' + second : second;\r\n        return year + '-' + month + '-' + dates + '\\t' + hour + ':' + minute + ':' + second;\r\n      },\r\n    },\r\n    created() {\r\n      this.getImageList()\r\n    },\r\n    methods: {\r\n      checkPermission,\r\n      async getImageList() {\r\n        let obj = {\r\n\r\n        }\r\n        const res = await this.api.image().getImageList(obj)\r\n        if (res.code == 1) {\r\n          this.imageList = res.data\r\n        }\r\n      },\r\n\r\n      async switchChange(obj) {\r\n        const res = await this.api.image().sysUpdateEnable(obj)\r\n        if (res.code == 1) {\r\n          this.$message.success('操作成功')\r\n        } else {\r\n          if (obj.enable == 1) {\r\n            obj.enable = 0\r\n          } else {\r\n            obj.enable = 1\r\n          }\r\n          this.$message.error('操作失败')\r\n        }\r\n      },\r\n\r\n      handleDelete({\r\n        $index,\r\n        row\r\n      }) {\r\n        this.$confirm('确定删除?', '提示', {\r\n            confirmButtonText: '确认',\r\n            cancelButtonText: '取消',\r\n            type: 'warning'\r\n          })\r\n          .then(async () => {\r\n            await this.api.image().sysDeleteImage({\r\n              'id': row.id\r\n            })\r\n            this.imageList.splice($index, 1)\r\n            this.$message({\r\n              type: 'success',\r\n              message: '删除成功!'\r\n            })\r\n          })\r\n          .catch(err => {\r\n            console.error(err)\r\n          })\r\n      },\r\n\n      handleCheckHidden(val) {\r\n        this.image.enable = val\r\n      },\r\n      handleAddImage() {\r\n        this.image = Object.assign({}, defaultImage)\r\n        this.dialogType = 'new'\r\n        this.dialogVisible = true\r\n      },\r\n\r\n      handleEdit(scope) {\r\n        this.dialogType = 'edit'\r\n        this.dialogVisible = true\r\n        this.checkStrictly = true\r\n        this.image = deepClone(scope.row)\r\n      },\r\n\r\n      beforeUpload(file) {\r\n        const isLt1M = file.size / 1024 / 1024 < 1;\r\n        if (!isLt1M) {\r\n          this.$message.error('文件大小不能超过 1M !');\r\n        }\r\n        return isLt1M;\r\n      },\r\n      httpRequest({\r\n        file\r\n      }) {\r\n        let that = this\r\n        //注意哦，这里指定文件夹'image/'，尝试过写在配置文件，但是各种不行，写在这里就可以\r\n        var fileName = 'mhjy/' + 'banner' + getFileNameUUID() + '.jpg';\r\n        client().put(fileName, file).then(({\r\n          res,\r\n          url,\r\n          name\r\n        }) => {\r\n          if (res && res.status == 200) {\r\n            // console.log(`阿里云OSS上传文件成功回调`, res, url, name);\r\n            this.image.src = url;\r\n          }\r\n        }).catch((err) => {\r\n          console.log(`阿里云OSS上传失败回调`, err);\r\n        });\r\n      },\r\n\r\n      async confirmImage() {\n        if (this.dialogType == 'new') {\n          const res = await this.api.image().sysAddImage(this.image)\n          if (res.code == 1) {\n            this.$message.success('新增成功')\n            this.dialogVisible = false\n            this.getImageList()\n          }\n        } else {\n          if (this.image.type == 1) {\n            this.image.link = ''\n          }\n          const res = await this.api.image().sysUpdateImage(this.image)\n          if (res.code == 1) {\n            this.$message.success('编辑成功')\n            this.dialogVisible = false\n            this.getImageList()\n          }\n        }\r\n      },\r\n\r\n    },\r\n  }\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n  .app-container {\n\n    .image-uploader {\n      background-color: #5cd7f7;\n      width: 80px;\n      height: 80px;\n      border-radius: 40px;\n      color: #000000;\n    }\n  }\r\n</style>\n"]}]}